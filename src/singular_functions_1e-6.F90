module singular_functions

implicit none

contains

   pure function sinx2_x(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 5.0e-1_8) then
         rslt = 0.5_8 + x**2*(-0.020833333333333333333333_8 + x**2*(0.00026041666666666666666667_8 + x**2*(-1.5500992063492063492063e-6_8 + x**2*(5.3822889109347442680776e-9_8 - 1.2232474797578964245631e-11_8*x**2))))
      else
         rslt = sin(x/2)/x
      end if
   end function sinx2_x

   pure function sinx_x(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 1.0_8) then
         rslt = 1._8 + x**2*(-0.16666666666666666666667_8 + x**2*(0.0083333333333333333333333_8 + x**2*(-0.00019841269841269841269841_8 + x**2*(2.7557319223985890652557e-6_8 + x**2*(-2.5052108385441718775052e-8_8 + x**2*(1.6059043836821614599392e-10_8 + x**2*(-7.6471637318198164759011e-13_8 + 2.8114572543455207631989e-15_8*x**2)))))))
      else
         rslt = sin(x)/x
      end if
   end function sinx_x

   pure function cosx_1_x2(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 1.0_8) then
         rslt = -0.5_8 + x**2*(0.041666666666666666666667_8 + x**2*(-0.0013888888888888888888889_8 + x**2*(0.000024801587301587301587302_8 + x**2*(-2.7557319223985890652557e-7_8 + x**2*(2.087675698786809897921e-9_8 + x**2*(-1.1470745597729724713852e-11_8 + 4.7794773323873852974382e-14_8*x**2))))))
      else
         rslt = (cos(x) - 1.0_8)/x**2
      end if
   end function cosx_1_x2

   pure function x_sinx_x3(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 9.0e-1_8) then
         rslt = 0.16666666666666666666667_8 + x**2*(-0.0083333333333333333333333_8 + x**2*(0.00019841269841269841269841_8 + x**2*(-2.7557319223985890652557e-6_8 + x**2*(2.5052108385441718775052e-8_8 + x**2*(-1.6059043836821614599392e-10_8 + x**2*(7.6471637318198164759011e-13_8 - 2.8114572543455207631989e-15_8*x**2))))))
      else
         rslt = (x - sin(x))/x**3
      end if
   end function x_sinx_x3

   pure function two_2cosx_xsinx_x4(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 1.0_8) then
         rslt = 0.083333333333333333333333_8 + x**2*(-0.0055555555555555555555556_8 + x**2*(0.00014880952380952380952381_8 + x**2*(-2.2045855379188712522046e-6_8 + x**2*(2.087675698786809897921e-8_8 + x**2*(-1.3764894717275669656622e-10_8 + x**2*(6.6912682653423394164135e-13_8 - 2.4990731149737962339546e-15_8*x**2))))))
      else
         rslt = (2.0_8 - 2*cos(x) - x*sin(x))/x**4
      end if
   end function two_2cosx_xsinx_x4

   pure function x_2_cosx_3sinx_x5(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 1.33333333333333333333333e0_8) then
         rslt = 0.016666666666666666666667_8 + x**2*(-0.00079365079365079365079365_8 + x**2*(0.000016534391534391534391534_8 + x**2*(-2.0041686708353375020042e-7_8 + x**2*(1.6059043836821614599392e-9_8 + x**2*(-9.1765964781837797710814e-12_8 + x**2*(3.9360401560837290684785e-14_8 - 1.315301639459892754713e-16_8*x**2))))))
      else
         rslt = (x*(2.0_8 + cos(x)) - 3*sin(x))/x**5
      end if
   end function x_2_cosx_3sinx_x5

   pure function two_xcotx2_2x2(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 9.0e-1_8) then
         rslt = 0.083333333333333333333333_8 + x**2*(0.0013888888888888888888889_8 + x**2*(0.000033068783068783068783069_8 + x**2*(8.2671957671957671957672e-7_8 + x**2*(2.087675698786809897921e-8_8 + x**2*(5.2841901386874931848477e-10_8 + x**2*(1.3382536530684678832827e-11_8 + x**2*(3.3896802963225828668302e-13_8 + 8.5860620562778445641359e-15_8*x**2)))))))
      else
         rslt = (2.0_8 - x/tan(x/2))/(2*x**2)
      end if
   end function two_xcotx2_2x2

   pure function two_acosx_sqrt_1_x2(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x > 1.0_8 - 5.0e-1_8) then
         rslt = 3.1415926435534479608581_8 + x*(-1.9999997293552890590492_8 + x*(1.5707928033954817480685_8 + x*(-1.3333038330598407696945_8 + x*(1.1779186834844996930214_8 + x*(-1.065833838762159172818_8 + x*(0.97863173472280045341345_8 + x*(-0.90467035725328856153076_8 + x*(0.83404900652533071595366_8 + x*(-0.757171265804559395263_8 + x*(0.66607981271574285738247_8 + x*(-0.55764724312506023400372_8 + x*(0.43631946666580290671102_8 + x*(-0.31368934558817708613085_8 + x*(0.2040918347173560527327_8 + x*(-0.11852302755867056783255_8 + x*(0.060645823804800265019719_8 + x*(-0.026986791604046923925395_8 + x*(0.01029644850616981308761_8 + x*(-0.0033126727940826681988413_8 + x*(0.00088012153801345011998479_8 + x*(-0.00018775828960563132305302_8 + x*(0.000030888327844850358781412_8 + x*(-3.6758235981162791012168e-6_8 + (2.8147049937858884784964e-7_8 - 1.0409411959267339047694e-8_8*x)*x)))))))))))))))))))))))
      else
         rslt = 2*acos(x)/sqrt(1 - x**2)
      end if
   end function two_acosx_sqrt_1_x2

   pure function xsinx_4cosx_x2_4_4sinx22_x4(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! result
      real(8)              :: rslt
      !
      if (x < 1.125e0_8) then
         rslt = 0.0027777777777777777777778_8 + x**2*(0.00013227513227513227513228_8 + x**2*(4.9603174603174603174603e-6_8 + x**2*(1.6701405590294479183368e-7_8 + x**2*(5.2841901386874931848477e-9_8 + x**2*(1.6059043836821614599392e-10_8 + x**2*(4.7455524148516160135623e-12_8 + x**2*(1.3737699290044551302617e-13_8 + x**2*(3.9147636574045113714747e-15_8 + 1.1018005656720459030405e-16_8*x**2))))))))
      else
         rslt = (x*sin(x) + 4*cos(x) + x**2 - 4.0_8)/(4 * sin(x/2)**2 * x**4)
      end if
   end function xsinx_4cosx_x2_4_4sinx22_x4

   pure function sixtyfour_12xcotx2_4x2_3_xcotx2_cosx_1_8x6(x) result(rslt)
      ! input
      real(8), intent(in)  :: x
      ! resul
      real(8)              :: rslt
      !
      if (x < 1.33333333333333333333333e0_8) then
         rslt = 0.00026455026455026455026455_8 + x**2*(0.000019841269841269841269841_8 + x**2*(1.0020843354176687510021e-6_8 + x**2*(4.2273521109499945478781e-8_8 + x**2*(1.6059043836821614599392e-9_8 + x**2*(5.6946628978219392162747e-11_8 + x**2*(1.9232779006062371823664e-12_8 + x**2*(6.2636218518472181943596e-14_8 + x**2*(1.983241018209682625473e-15_8 + x**2*(6.1399644617575102699114e-17_8 + 1.866325316924358825054e-18_8*x**2)))))))))
      else
         rslt = (64.0_8 - 12*x/tan(x/2) + (4*x**2*(3.0_8 + x/tan(x/2)))/(cos(x) - 1.0_8))/(8*x**6)
      end if
   end function sixtyfour_12xcotx2_4x2_3_xcotx2_cosx_1_8x6
end module singular_functions
